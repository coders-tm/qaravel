import{bw as C,cr as u,bJ as w,aL as m,a3 as p,b5 as y,aD as l,a6 as n,d as o,a5 as d,a4 as h,O as D,F as g,aa as U,bz as E,aJ as b,ar as N}from"./index.c62d8a64.js";import{Q as P}from"./QTimeline.7ca5248a.js";import{Q as A}from"./QPage.b2fd791d.js";import{S as J}from"./SkeletonSinglePage.f07820b6.js";import{u as j}from"./enquiry.e91658a3.js";import"./QSkeleton.2e510be2.js";const x={media:[]},z={components:{SkeletonSinglePage:J},data(){return{default:u.exports.cloneDeep(x),enquiry:u.exports.cloneDeep(x),loaded:!1,submited:!1}},methods:{...w(j,["store","show","update"]),onSubmit(r){console.func("pages/core/enquiries/EnquiryPage:methods.onSubmit()",arguments),this.submited=!0,(this.creating?this.store:this.update)(this.enquiry).then(({data:c,message:f})=>{this.submited=!1,this.$q.notify(f),this.enquiry=c,this.default=u.exports.cloneDeep(c),this.$router.push({name:"Single Enquiry",params:{id:c.id},query:{action:"edit"}})}).catch(c=>{this.submited=!1,this.$core.error(c,{title:"Error"})})},onReset(r){console.func("pages/core/enquiries/EnquiryPage:methods.onReset()",arguments),this.loaded=!1,this.$nextTick(()=>{this.enquiry=u.exports.cloneDeep(this.default),this.loaded=!0})},onCancel(r){console.func("pages/core/enquiries/EnquiryPage:methods.onCancel()",arguments),this.$router.go(-1)},onCreateNote(r){console.func("pages/core/enquiries/EnquiryPage:methods.onCreateNote()",arguments),r?(this.enquiry.replies.splice(0,0,u.exports.cloneDeep(r)),this.default.replies.splice(0,0,u.exports.cloneDeep(r))):this.show(this.id).then(t=>{this.enquiry=t,this.default=u.exports.cloneDeep(t)})}},async mounted(){this.creating?this.loaded=!0:this.show(this.id).then(r=>{this.$app.setTitle(r.subject||"Contact us"),this.enquiry=r,this.default=u.exports.cloneDeep(r),this.loaded=!0}).catch(r=>{this.$emit("error",r)})},computed:{edit(){return["add","edit"].includes(this.action)||this.id==="add"},creating(){return this.id==="add"},id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.enquiry)===JSON.stringify(this.default)},guard(){return this.$route.meta.guard},isAdmin(){return this.guard==="admins"},resetable(){return this.default&&JSON.stringify(this.enquiry)!==JSON.stringify(this.default)}}},B={class:"q-gutter-md"},O={key:0,class:"col-xs-12"},Q=n("div",{class:"text-label"},"Subject",-1),R=n("div",{class:"text-label"},"Message",-1),M={key:1,class:"col-xs-12 col-sm-6"},T=n("div",{class:"text-label"},"Attachment",-1),F={class:"col-xs-12 col-sm-2"},L={class:"col-xs-12 col-sm-2"},G={class:"col-xs-12 col-sm-2"},I={class:"col-xs-12 col-sm-2"},W={class:"col-xs-12 col-sm-2"},H={class:"col-xs-12 col-sm-2"},K={class:"col-xs-12 col-sm-12"},X={key:2,class:"col-xs-12"},Y={class:"files"},Z={class:"row q-col-gutter-sm"};function $(r,t,c,f,e,i){const a=m("base-input"),V=m("base-dropzone"),v=m("base-media-card"),q=m("base-section"),_=m("base-enquiry-reply-card"),k=m("base-form"),S=m("skeleton-single-page");return l(),p(A,{padding:""},{default:y(()=>[e.loaded?(l(),p(k,{key:0,onSubmit:i.onSubmit,onCancel:i.onCancel,onReset:i.onReset,resetable:i.resetable,disable:i.disable,submited:e.submited,"no-action":!i.creating},{default:y(()=>[n("div",B,[o(q,{title:i.creating?"General information":e.enquiry.subject||"Contact us"},{default:y(()=>[i.creating||!i.isAdmin?(l(),d(g,{key:0},[i.creating?(l(),d("div",O,[Q,o(a,{modelValue:e.enquiry.subject,"onUpdate:modelValue":t[0]||(t[0]=s=>e.enquiry.subject=s)},null,8,["modelValue"])])):h("",!0),n("div",{class:D({"col-xs-12":!0,"col-sm-6":i.creating})},[R,o(a,{autogrow:!i.creating,readonly:!i.creating,type:"textarea",rows:"9",modelValue:e.enquiry.message,"onUpdate:modelValue":t[1]||(t[1]=s=>e.enquiry.message=s)},null,8,["autogrow","readonly","modelValue"])],2),i.creating?(l(),d("div",M,[T,o(V,{modelValue:e.enquiry.media,"onUpdate:modelValue":t[2]||(t[2]=s=>e.enquiry.media=s)},null,8,["modelValue"])])):h("",!0)],64)):(l(),d(g,{key:1},[n("div",F,[o(a,{prefix:"ID:",readonly:"",modelValue:e.enquiry.id,"onUpdate:modelValue":t[3]||(t[3]=s=>e.enquiry.id=s)},null,8,["modelValue"])]),n("div",L,[o(a,{prefix:"Date:",readonly:"",modelValue:e.enquiry.created_at,"onUpdate:modelValue":t[4]||(t[4]=s=>e.enquiry.created_at=s)},null,8,["modelValue"])]),n("div",G,[o(a,{prefix:"User:",readonly:"",modelValue:e.enquiry.name,"onUpdate:modelValue":t[5]||(t[5]=s=>e.enquiry.name=s)},U({_:2},[e.enquiry.user?{name:"append",fn:y(()=>[o(E,{color:"primary",icon:"fas fa-arrow-up-right-from-square",flat:"",dense:"",round:"",size:"sm",tag:"a",to:{name:"Single Member",params:{id:e.enquiry.user.id},query:{action:"edit"}}},null,8,["to"])]),key:"0"}:void 0]),1032,["modelValue"])]),n("div",I,[o(a,{prefix:"Email:",readonly:"",modelValue:e.enquiry.email,"onUpdate:modelValue":t[6]||(t[6]=s=>e.enquiry.email=s)},null,8,["modelValue"])]),n("div",W,[o(a,{prefix:"Phone:",readonly:"",modelValue:e.enquiry.phone,"onUpdate:modelValue":t[7]||(t[7]=s=>e.enquiry.phone=s)},null,8,["modelValue"])]),n("div",H,[o(a,{prefix:"Status:",readonly:"",modelValue:e.enquiry.status,"onUpdate:modelValue":t[8]||(t[8]=s=>e.enquiry.status=s)},null,8,["modelValue"])]),n("div",K,[o(a,{prefix:"Message: ",autogrow:"",type:"textarea",readonly:"",modelValue:e.enquiry.message,"onUpdate:modelValue":t[9]||(t[9]=s=>e.enquiry.message=s)},null,8,["modelValue"])])],64)),!i.creating&&e.enquiry.media.length?(l(),d("div",X,[n("div",Y,[n("div",Z,[(l(!0),d(g,null,b(e.enquiry.media,s=>(l(),d("div",{key:s.id,class:"col-sm-2 col-xs-12"},[o(v,{media:s},null,8,["media"])]))),128))])])])):h("",!0)]),_:1},8,["title"]),i.creating?h("",!0):(l(),p(q,{key:0,title:"Activities",description:"With activity, you can view detailed histories and write reply for enquiry.","no-row":"","body-class":"q-px-lg"},{default:y(()=>[o(P,{class:"comments",color:"secondary"},{default:y(()=>[o(_,{"module-id":e.enquiry.id,class:"comment",creating:"",onCreate:i.onCreateNote,"is-admin":i.isAdmin},null,8,["module-id","onCreate","is-admin"]),(l(!0),d(g,null,b(e.enquiry.replies,s=>(l(),p(_,N({class:"comment",key:s.id},s,{"module-id":e.enquiry.id,user:s.user}),null,16,["module-id","user"]))),128))]),_:1})]),_:1}))])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited","no-action"])):(l(),p(S,{key:1}))]),_:1})}var re=C(z,[["render",$]]);export{re as default};
