(function() {
  /**
   * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
   *
   * @codingstandard ftlabs-jsv2
   * @copyright The Financial Times Limited [All Rights Reserved]
   * @license MIT License (see LICENSE.txt)
   */
  function FastClick(layer) {
    var oldOnClick;
    this.trackingClick = false;
    this.trackingClickStart = 0;
    this.targetElement = null;
    this.touchStartX = 0;
    this.touchStartY = 0;
    this.lastTouchIdentifier = 0;
    this.touchBoundary = 10;
    this.tapDelay = 200;
    this.tapTimeout = 700;
    function bind(method, context2) {
      return function() {
        return method.apply(context2, arguments);
      };
    }
    var methods = ["onMouse", "onClick", "onTouchStart", "onTouchMove", "onTouchEnd", "onTouchCancel"];
    var context = this;
    for (var i = 0, l = methods.length; i < l; i++) {
      context[methods[i]] = bind(context[methods[i]], context);
    }
    layer.addEventListener("click", this.onClick, true);
    layer.addEventListener("touchstart", this.onTouchStart, false);
    layer.addEventListener("touchmove", this.onTouchMove, false);
    layer.addEventListener("touchend", this.onTouchEnd, false);
    layer.addEventListener("touchcancel", this.onTouchCancel, false);
    if (!Event.prototype.stopImmediatePropagation) {
      layer.removeEventListener = function(type, callback, capture) {
        var rmv = Node.prototype.removeEventListener;
        if (type === "click") {
          rmv.call(layer, type, callback.hijacked || callback, capture);
        } else {
          rmv.call(layer, type, callback, capture);
        }
      };
      layer.addEventListener = function(type, callback, capture) {
        var adv = Node.prototype.addEventListener;
        if (type === "click") {
          adv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) {
            if (!event.propagationStopped) {
              callback(event);
            }
          }), capture);
        } else {
          adv.call(layer, type, callback, capture);
        }
      };
    }
    if (typeof layer.onclick === "function") {
      oldOnClick = layer.onclick;
      layer.addEventListener("click", function(event) {
        oldOnClick(event);
      }, false);
      layer.onclick = null;
    }
  }
  var inputTypes = ["email", "number", "password", "search", "tel", "text", "url"];
  FastClick.prototype.isInput = function(targetElement) {
    return targetElement.tagName.toLowerCase() === "textarea" || inputTypes.indexOf(targetElement.type) !== -1;
  };
  FastClick.prototype.needsClick = function(target) {
    switch (target.nodeName.toLowerCase()) {
      case "button":
      case "select":
      case "textarea":
        if (target.disabled) {
          return true;
        }
        break;
      case "input":
        if (target.type === "file" || target.disabled) {
          return true;
        }
        break;
      case "label":
      case "iframe":
      case "video":
        return true;
    }
    return /\bneedsclick\b/.test(target.className);
  };
  FastClick.prototype.needsFocus = function(target) {
    switch (target.nodeName.toLowerCase()) {
      case "textarea":
        return true;
      case "select":
        return true;
      case "input":
        switch (target.type) {
          case "button":
          case "checkbox":
          case "file":
          case "image":
          case "radio":
          case "submit":
            return false;
        }
        return !target.disabled && !target.readOnly;
      default:
        return /\bneedsfocus\b/.test(target.className);
    }
  };
  FastClick.prototype.sendClick = function(targetElement, event) {
    var clickEvent, touch;
    if (document.activeElement && document.activeElement !== targetElement) {
      document.activeElement.blur();
    }
    touch = event.changedTouches[0];
    clickEvent = document.createEvent("MouseEvents");
    clickEvent.initMouseEvent("click", true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);
    clickEvent.forwardedTouchEvent = true;
    targetElement.dispatchEvent(clickEvent);
  };
  FastClick.prototype.focus = function(targetElement) {
    var length;
    targetElement.focus();
    if (targetElement.setSelectionRange && targetElement.type.indexOf("date") !== 0 && targetElement.type !== "time" && targetElement.type !== "month" && targetElement.type !== "email" && targetElement.type !== "number") {
      length = targetElement.value.length;
      targetElement.setSelectionRange(length, length);
    }
  };
  FastClick.prototype.updateScrollParent = function(targetElement) {
    var scrollParent, parentElement;
    scrollParent = targetElement.fastClickScrollParent;
    if (!scrollParent || !scrollParent.contains(targetElement)) {
      parentElement = targetElement;
      do {
        if (parentElement.scrollHeight > parentElement.offsetHeight) {
          scrollParent = parentElement;
          targetElement.fastClickScrollParent = parentElement;
          break;
        }
        parentElement = parentElement.parentElement;
      } while (parentElement);
    }
    if (scrollParent) {
      scrollParent.fastClickLastScrollTop = scrollParent.scrollTop;
    }
  };
  FastClick.prototype.getTargetElementFromEventTarget = function(eventTarget) {
    if (eventTarget.nodeType === Node.TEXT_NODE) {
      return eventTarget.parentNode;
    }
    return eventTarget;
  };
  FastClick.prototype.onTouchStart = function(event) {
    var targetElement, touch;
    if (event.targetTouches.length > 1) {
      return true;
    }
    targetElement = this.getTargetElementFromEventTarget(event.target);
    touch = event.targetTouches[0];
    if (targetElement.isContentEditable) {
      return true;
    }
    if (targetElement === document.activeElement && this.isInput(targetElement)) {
      return true;
    }
    if (touch.identifier && touch.identifier === this.lastTouchIdentifier) {
      event.preventDefault();
      return false;
    }
    this.lastTouchIdentifier = touch.identifier;
    this.updateScrollParent(targetElement);
    this.trackingClick = true;
    this.trackingClickStart = event.timeStamp;
    this.targetElement = targetElement;
    this.touchStartX = touch.pageX;
    this.touchStartY = touch.pageY;
    if (event.timeStamp - this.lastClickTime < this.tapDelay) {
      event.preventDefault();
    }
    return true;
  };
  FastClick.prototype.touchHasMoved = function(event) {
    var touch = event.changedTouches[0], boundary = this.touchBoundary;
    if (Math.abs(touch.pageX - this.touchStartX) > boundary || Math.abs(touch.pageY - this.touchStartY) > boundary) {
      return true;
    }
    return false;
  };
  FastClick.prototype.onTouchMove = function(event) {
    if (!this.trackingClick) {
      return true;
    }
    if (this.targetElement !== this.getTargetElementFromEventTarget(event.target) || this.touchHasMoved(event)) {
      this.trackingClick = false;
      this.targetElement = null;
    }
    return true;
  };
  FastClick.prototype.findControl = function(labelElement) {
    if (labelElement.control !== void 0) {
      return labelElement.control;
    }
    if (labelElement.htmlFor) {
      return document.getElementById(labelElement.htmlFor);
    }
    return labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea");
  };
  FastClick.prototype.onTouchEnd = function(event) {
    var forElement, trackingClickStart, targetTagName, scrollParent, targetElement = this.targetElement;
    if (!this.trackingClick) {
      return true;
    }
    if (event.timeStamp - this.lastClickTime < this.tapDelay) {
      this.cancelNextClick = true;
      return true;
    }
    if (event.timeStamp - this.trackingClickStart > this.tapTimeout) {
      return true;
    }
    this.cancelNextClick = false;
    this.lastClickTime = event.timeStamp;
    trackingClickStart = this.trackingClickStart;
    this.trackingClick = false;
    this.trackingClickStart = 0;
    targetTagName = targetElement.tagName.toLowerCase();
    if (targetTagName === "label") {
      forElement = this.findControl(targetElement);
      if (forElement) {
        this.focus(targetElement);
        targetElement = forElement;
      }
    } else if (this.needsFocus(targetElement)) {
      if (event.timeStamp - trackingClickStart > 100 || window.top !== window && targetTagName === "input") {
        this.targetElement = null;
        return false;
      }
      this.focus(targetElement);
      this.sendClick(targetElement, event);
      if (targetTagName !== "select") {
        this.targetElement = null;
        event.preventDefault();
      }
      return false;
    }
    scrollParent = targetElement.fastClickScrollParent;
    if (scrollParent && scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {
      return true;
    }
    if (!this.needsClick(targetElement)) {
      event.preventDefault();
      this.sendClick(targetElement, event);
    }
    return false;
  };
  FastClick.prototype.onTouchCancel = function() {
    this.trackingClick = false;
    this.targetElement = null;
  };
  FastClick.prototype.onMouse = function(event) {
    if (!this.targetElement) {
      return true;
    }
    if (event.forwardedTouchEvent) {
      return true;
    }
    if (!event.cancelable) {
      return true;
    }
    if (!this.needsClick(this.targetElement) || this.cancelNextClick) {
      if (event.stopImmediatePropagation) {
        event.stopImmediatePropagation();
      } else {
        event.propagationStopped = true;
      }
      event.stopPropagation();
      event.preventDefault();
      return false;
    }
    return true;
  };
  FastClick.prototype.onClick = function(event) {
    var permitted;
    if (this.trackingClick) {
      this.targetElement = null;
      this.trackingClick = false;
      return true;
    }
    if (event.target.type === "submit" && event.detail === 0) {
      return true;
    }
    permitted = this.onMouse(event);
    if (!permitted) {
      this.targetElement = null;
    }
    return permitted;
  };
  function init() {
    new FastClick(document.body);
  }
  if (document.readyState !== "loading") {
    return init();
  }
  document.addEventListener("DOMContentLoaded", init, false);
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFzdGNsaWNrLjhhNGE4MjY3LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9ub2RlX21vZHVsZXMvQHF1YXNhci9mYXN0Y2xpY2svZmFzdGNsaWNrLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0J1xuXG4gIC8qKlxuICAgKiBXQVJOSU5HISEhIVxuICAgKiBGb3IgUXVhc2FyIEZyYW1ld29yaywgdGhpcyBpcyBvbmx5IG5lZWRlZCBmb3JcbiAgICogaU9TIChQV0Egb3IgQ29yZG92YSkgcGxhdGZvcm0uIFRoaXMgaXMgYXNzdW1lZCBieSBkZWZhdWx0LlxuICAgKi9cblxuICAvKipcbiAgICogQHByZXNlcnZlIEZhc3RDbGljazogcG9seWZpbGwgdG8gcmVtb3ZlIGNsaWNrIGRlbGF5cyBvbiBicm93c2VycyB3aXRoIHRvdWNoIFVJcy5cbiAgICpcbiAgICogQGNvZGluZ3N0YW5kYXJkIGZ0bGFicy1qc3YyXG4gICAqIEBjb3B5cmlnaHQgVGhlIEZpbmFuY2lhbCBUaW1lcyBMaW1pdGVkIFtBbGwgUmlnaHRzIFJlc2VydmVkXVxuICAgKiBAbGljZW5zZSBNSVQgTGljZW5zZSAoc2VlIExJQ0VOU0UudHh0KVxuICAgKi9cblxuICAvKmpzbGludCBicm93c2VyOnRydWUsIG5vZGU6dHJ1ZSovXG4gIC8qZ2xvYmFsIGRlZmluZSwgRXZlbnQsIE5vZGUqL1xuXG5cbiAgLyoqXG4gICAqIEluc3RhbnRpYXRlIGZhc3QtY2xpY2tpbmcgbGlzdGVuZXJzIG9uIHRoZSBzcGVjaWZpZWQgbGF5ZXIuXG4gICAqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGxheWVyIFRoZSBsYXllciB0byBsaXN0ZW4gb25cbiAgICovXG4gIGZ1bmN0aW9uIEZhc3RDbGljayhsYXllcikge1xuICAgIHZhciBvbGRPbkNsaWNrXG5cbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIGEgY2xpY2sgaXMgY3VycmVudGx5IGJlaW5nIHRyYWNrZWQuXG4gICAgICpcbiAgICAgKiBAdHlwZSBib29sZWFuXG4gICAgICovXG4gICAgdGhpcy50cmFja2luZ0NsaWNrID0gZmFsc2VcblxuXG4gICAgLyoqXG4gICAgICogVGltZXN0YW1wIGZvciB3aGVuIGNsaWNrIHRyYWNraW5nIHN0YXJ0ZWQuXG4gICAgICpcbiAgICAgKiBAdHlwZSBudW1iZXJcbiAgICAgKi9cbiAgICB0aGlzLnRyYWNraW5nQ2xpY2tTdGFydCA9IDBcblxuXG4gICAgLyoqXG4gICAgICogVGhlIGVsZW1lbnQgYmVpbmcgdHJhY2tlZCBmb3IgYSBjbGljay5cbiAgICAgKlxuICAgICAqIEB0eXBlIEV2ZW50VGFyZ2V0XG4gICAgICovXG4gICAgdGhpcy50YXJnZXRFbGVtZW50ID0gbnVsbFxuXG5cbiAgICAvKipcbiAgICAgKiBYLWNvb3JkaW5hdGUgb2YgdG91Y2ggc3RhcnQgZXZlbnQuXG4gICAgICpcbiAgICAgKiBAdHlwZSBudW1iZXJcbiAgICAgKi9cbiAgICB0aGlzLnRvdWNoU3RhcnRYID0gMFxuXG5cbiAgICAvKipcbiAgICAgKiBZLWNvb3JkaW5hdGUgb2YgdG91Y2ggc3RhcnQgZXZlbnQuXG4gICAgICpcbiAgICAgKiBAdHlwZSBudW1iZXJcbiAgICAgKi9cbiAgICB0aGlzLnRvdWNoU3RhcnRZID0gMFxuXG5cbiAgICAvKipcbiAgICAgKiBJRCBvZiB0aGUgbGFzdCB0b3VjaCwgcmV0cmlldmVkIGZyb20gVG91Y2guaWRlbnRpZmllci5cbiAgICAgKlxuICAgICAqIEB0eXBlIG51bWJlclxuICAgICAqL1xuICAgIHRoaXMubGFzdFRvdWNoSWRlbnRpZmllciA9IDBcblxuXG4gICAgLyoqXG4gICAgICogVG91Y2htb3ZlIGJvdW5kYXJ5LCBiZXlvbmQgd2hpY2ggYSBjbGljayB3aWxsIGJlIGNhbmNlbGxlZC5cbiAgICAgKlxuICAgICAqIEB0eXBlIG51bWJlclxuICAgICAqL1xuICAgIHRoaXMudG91Y2hCb3VuZGFyeSA9IDEwXG5cbiAgICAvKipcbiAgICAgKiBUaGUgbWluaW11bSB0aW1lIGJldHdlZW4gdGFwKHRvdWNoc3RhcnQgYW5kIHRvdWNoZW5kKSBldmVudHNcbiAgICAgKlxuICAgICAqIEB0eXBlIG51bWJlclxuICAgICAqL1xuICAgIHRoaXMudGFwRGVsYXkgPSAyMDBcblxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIHRpbWUgZm9yIGEgdGFwXG4gICAgICpcbiAgICAgKiBAdHlwZSBudW1iZXJcbiAgICAgKi9cbiAgICB0aGlzLnRhcFRpbWVvdXQgPSA3MDBcblxuICAgIC8vIFNvbWUgb2xkIHZlcnNpb25zIG9mIEFuZHJvaWQgZG9uJ3QgaGF2ZSBGdW5jdGlvbi5wcm90b3R5cGUuYmluZFxuICAgIGZ1bmN0aW9uIGJpbmQobWV0aG9kLCBjb250ZXh0KSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVybiBtZXRob2QuYXBwbHkoY29udGV4dCwgYXJndW1lbnRzKSB9XG4gICAgfVxuXG5cbiAgICB2YXIgbWV0aG9kcyA9IFsnb25Nb3VzZScsICdvbkNsaWNrJywgJ29uVG91Y2hTdGFydCcsICdvblRvdWNoTW92ZScsICdvblRvdWNoRW5kJywgJ29uVG91Y2hDYW5jZWwnXTtcbiAgICB2YXIgY29udGV4dCA9IHRoaXNcbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IG1ldGhvZHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBjb250ZXh0W21ldGhvZHNbaV1dID0gYmluZChjb250ZXh0W21ldGhvZHNbaV1dLCBjb250ZXh0KVxuICAgIH1cblxuICAgIGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbkNsaWNrLCB0cnVlKVxuICAgIGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLm9uVG91Y2hTdGFydCwgZmFsc2UpXG4gICAgbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5vblRvdWNoTW92ZSwgZmFsc2UpXG4gICAgbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLm9uVG91Y2hFbmQsIGZhbHNlKVxuICAgIGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoY2FuY2VsJywgdGhpcy5vblRvdWNoQ2FuY2VsLCBmYWxzZSlcblxuICAgIC8vIEhhY2sgaXMgcmVxdWlyZWQgZm9yIGJyb3dzZXJzIHRoYXQgZG9uJ3Qgc3VwcG9ydCBFdmVudCNzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gKGUuZy4gQW5kcm9pZCAyKVxuICAgIC8vIHdoaWNoIGlzIGhvdyBGYXN0Q2xpY2sgbm9ybWFsbHkgc3RvcHMgY2xpY2sgZXZlbnRzIGJ1YmJsaW5nIHRvIGNhbGxiYWNrcyByZWdpc3RlcmVkIG9uIHRoZSBGYXN0Q2xpY2tcbiAgICAvLyBsYXllciB3aGVuIHRoZXkgYXJlIGNhbmNlbGxlZC5cbiAgICBpZiAoIUV2ZW50LnByb3RvdHlwZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24pIHtcbiAgICAgIGxheWVyLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBjYWxsYmFjaywgY2FwdHVyZSkge1xuICAgICAgICB2YXIgcm12ID0gTm9kZS5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lclxuICAgICAgICBpZiAodHlwZSA9PT0gJ2NsaWNrJykge1xuICAgICAgICAgIHJtdi5jYWxsKGxheWVyLCB0eXBlLCBjYWxsYmFjay5oaWphY2tlZCB8fCBjYWxsYmFjaywgY2FwdHVyZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBybXYuY2FsbChsYXllciwgdHlwZSwgY2FsbGJhY2ssIGNhcHR1cmUpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGNhbGxiYWNrLCBjYXB0dXJlKSB7XG4gICAgICAgIHZhciBhZHYgPSBOb2RlLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyXG4gICAgICAgIGlmICh0eXBlID09PSAnY2xpY2snKSB7XG4gICAgICAgICAgYWR2LmNhbGwobGF5ZXIsIHR5cGUsIGNhbGxiYWNrLmhpamFja2VkIHx8IChjYWxsYmFjay5oaWphY2tlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoIWV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZCkge1xuICAgICAgICAgICAgICBjYWxsYmFjayhldmVudClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSwgY2FwdHVyZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhZHYuY2FsbChsYXllciwgdHlwZSwgY2FsbGJhY2ssIGNhcHR1cmUpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiBhIGhhbmRsZXIgaXMgYWxyZWFkeSBkZWNsYXJlZCBpbiB0aGUgZWxlbWVudCdzIG9uY2xpY2sgYXR0cmlidXRlLCBpdCB3aWxsIGJlIGZpcmVkIGJlZm9yZVxuICAgIC8vIEZhc3RDbGljaydzIG9uQ2xpY2sgaGFuZGxlci4gRml4IHRoaXMgYnkgcHVsbGluZyBvdXQgdGhlIHVzZXItZGVmaW5lZCBoYW5kbGVyIGZ1bmN0aW9uIGFuZFxuICAgIC8vIGFkZGluZyBpdCBhcyBsaXN0ZW5lci5cbiAgICBpZiAodHlwZW9mIGxheWVyLm9uY2xpY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIC8vIEFuZHJvaWQgYnJvd3NlciBvbiBhdCBsZWFzdCAzLjIgcmVxdWlyZXMgYSBuZXcgcmVmZXJlbmNlIHRvIHRoZSBmdW5jdGlvbiBpbiBsYXllci5vbmNsaWNrXG4gICAgICAvLyAtIHRoZSBvbGQgb25lIHdvbid0IHdvcmsgaWYgcGFzc2VkIHRvIGFkZEV2ZW50TGlzdGVuZXIgZGlyZWN0bHkuXG4gICAgICBvbGRPbkNsaWNrID0gbGF5ZXIub25jbGlja1xuICAgICAgbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBvbGRPbkNsaWNrKGV2ZW50KVxuICAgICAgfSwgZmFsc2UpXG4gICAgICBsYXllci5vbmNsaWNrID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZCB0eXBlcyBmb3IgdGV4dCBpbnB1dHNcbiAgICpcbiAgICogQHR5cGUgYXJyYXlcbiAgICovXG4gIHZhciBpbnB1dFR5cGVzID0gWydlbWFpbCcsICdudW1iZXInLCAncGFzc3dvcmQnLCAnc2VhcmNoJywgJ3RlbCcsICd0ZXh0JywgJ3VybCddXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7RXZlbnRUYXJnZXR9IHRhcmdldEVsZW1lbnRcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBGYXN0Q2xpY2sucHJvdG90eXBlLmlzSW5wdXQgPSBmdW5jdGlvbih0YXJnZXRFbGVtZW50KSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRhcmdldEVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAndGV4dGFyZWEnXG4gICAgICB8fCBpbnB1dFR5cGVzLmluZGV4T2YodGFyZ2V0RWxlbWVudC50eXBlKSAhPT0gLTFcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lIHdoZXRoZXIgYSBnaXZlbiBlbGVtZW50IHJlcXVpcmVzIGEgbmF0aXZlIGNsaWNrLlxuICAgKlxuICAgKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fEVsZW1lbnR9IHRhcmdldCBUYXJnZXQgRE9NIGVsZW1lbnRcbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB0aGUgZWxlbWVudCBuZWVkcyBhIG5hdGl2ZSBjbGlja1xuICAgKi9cbiAgRmFzdENsaWNrLnByb3RvdHlwZS5uZWVkc0NsaWNrID0gZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgc3dpdGNoICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkge1xuXG4gICAgLy8gRG9uJ3Qgc2VuZCBhIHN5bnRoZXRpYyBjbGljayB0byBkaXNhYmxlZCBpbnB1dHMgKGlzc3VlICM2MilcbiAgICBjYXNlICdidXR0b24nOlxuICAgIGNhc2UgJ3NlbGVjdCc6XG4gICAgY2FzZSAndGV4dGFyZWEnOlxuICAgICAgaWYgKHRhcmdldC5kaXNhYmxlZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuXG4gICAgICBicmVha1xuICAgIGNhc2UgJ2lucHV0JzpcblxuICAgICAgLy8gRmlsZSBpbnB1dHMgbmVlZCByZWFsIGNsaWNrcyBvbiBpT1MgNiBkdWUgdG8gYSBicm93c2VyIGJ1ZyAoaXNzdWUgIzY4KVxuICAgICAgaWYgKHRhcmdldC50eXBlID09PSAnZmlsZScgfHwgdGFyZ2V0LmRpc2FibGVkKSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG5cbiAgICAgIGJyZWFrXG4gICAgY2FzZSAnbGFiZWwnOlxuICAgIGNhc2UgJ2lmcmFtZSc6IC8vIGlPUzggaG9tZXNjcmVlbiBhcHBzIGNhbiBwcmV2ZW50IGV2ZW50cyBidWJibGluZyBpbnRvIGZyYW1lc1xuICAgIGNhc2UgJ3ZpZGVvJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgcmV0dXJuICgvXFxibmVlZHNjbGlja1xcYi8pLnRlc3QodGFyZ2V0LmNsYXNzTmFtZSlcbiAgfVxuXG5cbiAgLyoqXG4gICAqIERldGVybWluZSB3aGV0aGVyIGEgZ2l2ZW4gZWxlbWVudCByZXF1aXJlcyBhIGNhbGwgdG8gZm9jdXMgdG8gc2ltdWxhdGUgY2xpY2sgaW50byBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fEVsZW1lbnR9IHRhcmdldCBUYXJnZXQgRE9NIGVsZW1lbnRcbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB0aGUgZWxlbWVudCByZXF1aXJlcyBhIGNhbGwgdG8gZm9jdXMgdG8gc2ltdWxhdGUgbmF0aXZlIGNsaWNrLlxuICAgKi9cbiAgRmFzdENsaWNrLnByb3RvdHlwZS5uZWVkc0ZvY3VzID0gZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgc3dpdGNoICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgIGNhc2UgJ3RleHRhcmVhJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgY2FzZSAnc2VsZWN0JzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgY2FzZSAnaW5wdXQnOlxuICAgICAgc3dpdGNoICh0YXJnZXQudHlwZSkge1xuICAgICAgY2FzZSAnYnV0dG9uJzpcbiAgICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICAgIGNhc2UgJ2ZpbGUnOlxuICAgICAgY2FzZSAnaW1hZ2UnOlxuICAgICAgY2FzZSAncmFkaW8nOlxuICAgICAgY2FzZSAnc3VibWl0JzpcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG5cbiAgICAgIC8vIE5vIHBvaW50IGluIGF0dGVtcHRpbmcgdG8gZm9jdXMgZGlzYWJsZWQgaW5wdXRzXG4gICAgICByZXR1cm4gIXRhcmdldC5kaXNhYmxlZCAmJiAhdGFyZ2V0LnJlYWRPbmx5XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiAoL1xcYm5lZWRzZm9jdXNcXGIvKS50ZXN0KHRhcmdldC5jbGFzc05hbWUpXG4gICAgfVxuICB9XG5cblxuICAvKipcbiAgICogU2VuZCBhIGNsaWNrIGV2ZW50IHRvIHRoZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAgICpcbiAgICogQHBhcmFtIHtFdmVudFRhcmdldHxFbGVtZW50fSB0YXJnZXRFbGVtZW50XG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqL1xuICBGYXN0Q2xpY2sucHJvdG90eXBlLnNlbmRDbGljayA9IGZ1bmN0aW9uKHRhcmdldEVsZW1lbnQsIGV2ZW50KSB7XG4gICAgdmFyIGNsaWNrRXZlbnQsIHRvdWNoXG5cbiAgICAvLyBPbiBzb21lIEFuZHJvaWQgZGV2aWNlcyBhY3RpdmVFbGVtZW50IG5lZWRzIHRvIGJlIGJsdXJyZWQgb3RoZXJ3aXNlIHRoZSBzeW50aGV0aWMgY2xpY2sgd2lsbCBoYXZlIG5vIGVmZmVjdCAoIzI0KVxuICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IHRhcmdldEVsZW1lbnQpIHtcbiAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpXG4gICAgfVxuXG4gICAgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXVxuXG4gICAgLy8gU3ludGhlc2l6ZSBhIGNsaWNrIGV2ZW50LCB3aXRoIGFuIGV4dHJhIGF0dHJpYnV0ZSBzbyBpdCBjYW4gYmUgdHJhY2tlZFxuICAgIGNsaWNrRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKVxuICAgIGNsaWNrRXZlbnQuaW5pdE1vdXNlRXZlbnQoJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSwgd2luZG93LCAxLCB0b3VjaC5zY3JlZW5YLCB0b3VjaC5zY3JlZW5ZLCB0b3VjaC5jbGllbnRYLCB0b3VjaC5jbGllbnRZLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMCwgbnVsbClcbiAgICBjbGlja0V2ZW50LmZvcndhcmRlZFRvdWNoRXZlbnQgPSB0cnVlXG4gICAgdGFyZ2V0RWxlbWVudC5kaXNwYXRjaEV2ZW50KGNsaWNrRXZlbnQpXG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtFdmVudFRhcmdldHxFbGVtZW50fSB0YXJnZXRFbGVtZW50XG4gICAqL1xuICBGYXN0Q2xpY2sucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24odGFyZ2V0RWxlbWVudCkge1xuICAgIHZhciBsZW5ndGhcblxuICAgIHRhcmdldEVsZW1lbnQuZm9jdXMoKVxuXG4gICAgLy8gSXNzdWUgIzE2MDogb24gaU9TIDcsIHNvbWUgaW5wdXQgZWxlbWVudHMgKGUuZy4gZGF0ZSBkYXRldGltZSBtb250aCkgdGhyb3cgYSB2YWd1ZSBUeXBlRXJyb3Igb24gc2V0U2VsZWN0aW9uUmFuZ2UuIFRoZXNlIGVsZW1lbnRzIGRvbid0IGhhdmUgYW4gaW50ZWdlciB2YWx1ZSBmb3IgdGhlIHNlbGVjdGlvblN0YXJ0IGFuZCBzZWxlY3Rpb25FbmQgcHJvcGVydGllcywgYnV0IHVuZm9ydHVuYXRlbHkgdGhhdCBjYW4ndCBiZSB1c2VkIGZvciBkZXRlY3Rpb24gYmVjYXVzZSBhY2Nlc3NpbmcgdGhlIHByb3BlcnRpZXMgYWxzbyB0aHJvd3MgYSBUeXBlRXJyb3IuIEp1c3QgY2hlY2sgdGhlIHR5cGUgaW5zdGVhZC4gRmlsZWQgYXMgQXBwbGUgYnVnICMxNTEyMjcyNC5cbiAgICBpZiAodGFyZ2V0RWxlbWVudC5zZXRTZWxlY3Rpb25SYW5nZSAmJiB0YXJnZXRFbGVtZW50LnR5cGUuaW5kZXhPZignZGF0ZScpICE9PSAwICYmIHRhcmdldEVsZW1lbnQudHlwZSAhPT0gJ3RpbWUnICYmIHRhcmdldEVsZW1lbnQudHlwZSAhPT0gJ21vbnRoJyAmJiB0YXJnZXRFbGVtZW50LnR5cGUgIT09ICdlbWFpbCcgJiYgdGFyZ2V0RWxlbWVudC50eXBlICE9PSAnbnVtYmVyJykge1xuICAgICAgbGVuZ3RoID0gdGFyZ2V0RWxlbWVudC52YWx1ZS5sZW5ndGhcbiAgICAgIHRhcmdldEVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UobGVuZ3RoLCBsZW5ndGgpXG4gICAgfVxuICB9XG5cblxuICAvKipcbiAgICogQ2hlY2sgd2hldGhlciB0aGUgZ2l2ZW4gdGFyZ2V0IGVsZW1lbnQgaXMgYSBjaGlsZCBvZiBhIHNjcm9sbGFibGUgbGF5ZXIgYW5kIGlmIHNvLCBzZXQgYSBmbGFnIG9uIGl0LlxuICAgKlxuICAgKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fEVsZW1lbnR9IHRhcmdldEVsZW1lbnRcbiAgICovXG4gIEZhc3RDbGljay5wcm90b3R5cGUudXBkYXRlU2Nyb2xsUGFyZW50ID0gZnVuY3Rpb24odGFyZ2V0RWxlbWVudCkge1xuICAgIHZhciBzY3JvbGxQYXJlbnQsIHBhcmVudEVsZW1lbnRcblxuICAgIHNjcm9sbFBhcmVudCA9IHRhcmdldEVsZW1lbnQuZmFzdENsaWNrU2Nyb2xsUGFyZW50XG5cbiAgICAvLyBBdHRlbXB0IHRvIGRpc2NvdmVyIHdoZXRoZXIgdGhlIHRhcmdldCBlbGVtZW50IGlzIGNvbnRhaW5lZCB3aXRoaW4gYSBzY3JvbGxhYmxlIGxheWVyLiBSZS1jaGVjayBpZiB0aGVcbiAgICAvLyB0YXJnZXQgZWxlbWVudCB3YXMgbW92ZWQgdG8gYW5vdGhlciBwYXJlbnQuXG4gICAgaWYgKCFzY3JvbGxQYXJlbnQgfHwgIXNjcm9sbFBhcmVudC5jb250YWlucyh0YXJnZXRFbGVtZW50KSkge1xuICAgICAgcGFyZW50RWxlbWVudCA9IHRhcmdldEVsZW1lbnRcbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKHBhcmVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0ID4gcGFyZW50RWxlbWVudC5vZmZzZXRIZWlnaHQpIHtcbiAgICAgICAgICBzY3JvbGxQYXJlbnQgPSBwYXJlbnRFbGVtZW50XG4gICAgICAgICAgdGFyZ2V0RWxlbWVudC5mYXN0Q2xpY2tTY3JvbGxQYXJlbnQgPSBwYXJlbnRFbGVtZW50XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnRcbiAgICAgIH0gd2hpbGUgKHBhcmVudEVsZW1lbnQpXG4gICAgfVxuXG4gICAgLy8gQWx3YXlzIHVwZGF0ZSB0aGUgc2Nyb2xsIHRvcCB0cmFja2VyIGlmIHBvc3NpYmxlLlxuICAgIGlmIChzY3JvbGxQYXJlbnQpIHtcbiAgICAgIHNjcm9sbFBhcmVudC5mYXN0Q2xpY2tMYXN0U2Nyb2xsVG9wID0gc2Nyb2xsUGFyZW50LnNjcm9sbFRvcFxuICAgIH1cbiAgfVxuXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7RXZlbnRUYXJnZXR9IHRhcmdldEVsZW1lbnRcbiAgICogQHJldHVybnMge0VsZW1lbnR8RXZlbnRUYXJnZXR9XG4gICAqL1xuICBGYXN0Q2xpY2sucHJvdG90eXBlLmdldFRhcmdldEVsZW1lbnRGcm9tRXZlbnRUYXJnZXQgPSBmdW5jdGlvbihldmVudFRhcmdldCkge1xuXG4gICAgLy8gT24gc29tZSBvbGRlciBicm93c2VycyAobm90YWJseSBTYWZhcmkgb24gaU9TIDQuMSAtIHNlZSBpc3N1ZSAjNTYpIHRoZSBldmVudCB0YXJnZXQgbWF5IGJlIGEgdGV4dCBub2RlLlxuICAgIGlmIChldmVudFRhcmdldC5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgIHJldHVybiBldmVudFRhcmdldC5wYXJlbnROb2RlXG4gICAgfVxuXG4gICAgcmV0dXJuIGV2ZW50VGFyZ2V0XG4gIH1cblxuXG4gIC8qKlxuICAgKiBPbiB0b3VjaCBzdGFydCwgcmVjb3JkIHRoZSBwb3NpdGlvbiBhbmQgc2Nyb2xsIG9mZnNldC5cbiAgICpcbiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBGYXN0Q2xpY2sucHJvdG90eXBlLm9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIHRhcmdldEVsZW1lbnQsIHRvdWNoXG5cbiAgICAvLyBJZ25vcmUgbXVsdGlwbGUgdG91Y2hlcywgb3RoZXJ3aXNlIHBpbmNoLXRvLXpvb20gaXMgcHJldmVudGVkIGlmIGJvdGggZmluZ2VycyBhcmUgb24gdGhlIEZhc3RDbGljayBlbGVtZW50IChpc3N1ZSAjMTExKS5cbiAgICBpZiAoZXZlbnQudGFyZ2V0VG91Y2hlcy5sZW5ndGggPiAxKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHRhcmdldEVsZW1lbnQgPSB0aGlzLmdldFRhcmdldEVsZW1lbnRGcm9tRXZlbnRUYXJnZXQoZXZlbnQudGFyZ2V0KVxuICAgIHRvdWNoID0gZXZlbnQudGFyZ2V0VG91Y2hlc1swXVxuXG4gICAgLy8gSWdub3JlIHRvdWNoZXMgb24gY29udGVudGVkaXRhYmxlIGVsZW1lbnRzIHRvIHByZXZlbnQgY29uZmxpY3Qgd2l0aCB0ZXh0IHNlbGVjdGlvbi5cbiAgICAvLyAoRm9yIGRldGFpbHM6IGh0dHBzOi8vZ2l0aHViLmNvbS9mdGxhYnMvZmFzdGNsaWNrL3B1bGwvMjExIClcbiAgICBpZiAodGFyZ2V0RWxlbWVudC5pc0NvbnRlbnRFZGl0YWJsZSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICAvLyBpZ25vcmUgdG91Y2hzdGFydCBpbiBmb2N1c2VkIGlucHV0cywgb3RoZXJ3aXNlIHVzZXIgbmVlZHMgdG8gaG9sZCB0aGUgaW5wdXRcbiAgICAvLyBmb3IgdGhlIGNvcHkvcGFzdGUgbWVudVxuICAgIGlmICh0YXJnZXRFbGVtZW50ID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIHRoaXMuaXNJbnB1dCh0YXJnZXRFbGVtZW50KSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICAvLyBXZWlyZCB0aGluZ3MgaGFwcGVuIG9uIGlPUyB3aGVuIGFuIGFsZXJ0IG9yIGNvbmZpcm0gZGlhbG9nIGlzIG9wZW5lZCBmcm9tIGEgY2xpY2sgZXZlbnQgY2FsbGJhY2sgKGlzc3VlICMyMyk6XG4gICAgLy8gd2hlbiB0aGUgdXNlciBuZXh0IHRhcHMgYW55d2hlcmUgZWxzZSBvbiB0aGUgcGFnZSwgbmV3IHRvdWNoc3RhcnQgYW5kIHRvdWNoZW5kIGV2ZW50cyBhcmUgZGlzcGF0Y2hlZFxuICAgIC8vIHdpdGggdGhlIHNhbWUgaWRlbnRpZmllciBhcyB0aGUgdG91Y2ggZXZlbnQgdGhhdCBwcmV2aW91c2x5IHRyaWdnZXJlZCB0aGUgY2xpY2sgdGhhdCB0cmlnZ2VyZWQgdGhlIGFsZXJ0LlxuICAgIC8vIFNhZGx5LCB0aGVyZSBpcyBhbiBpc3N1ZSBvbiBpT1MgNCB0aGF0IGNhdXNlcyBzb21lIG5vcm1hbCB0b3VjaCBldmVudHMgdG8gaGF2ZSB0aGUgc2FtZSBpZGVudGlmaWVyIGFzIGFuXG4gICAgLy8gaW1tZWRpYXRlbHkgcHJlY2VkaW5nIHRvdWNoIGV2ZW50IChpc3N1ZSAjNTIpLCBzbyB0aGlzIGZpeCBpcyB1bmF2YWlsYWJsZSBvbiB0aGF0IHBsYXRmb3JtLlxuICAgIC8vIElzc3VlIDEyMDogdG91Y2guaWRlbnRpZmllciBpcyAwIHdoZW4gQ2hyb21lIGRldiB0b29scyAnRW11bGF0ZSB0b3VjaCBldmVudHMnIGlzIHNldCB3aXRoIGFuIGlPUyBkZXZpY2UgVUEgc3RyaW5nLFxuICAgIC8vIHdoaWNoIGNhdXNlcyBhbGwgdG91Y2ggZXZlbnRzIHRvIGJlIGlnbm9yZWQuIEFzIHRoaXMgYmxvY2sgb25seSBhcHBsaWVzIHRvIGlPUywgYW5kIGlPUyBpZGVudGlmaWVycyBhcmUgYWx3YXlzIGxvbmcsXG4gICAgLy8gcmFuZG9tIGludGVnZXJzLCBpdCdzIHNhZmUgdG8gdG8gY29udGludWUgaWYgdGhlIGlkZW50aWZpZXIgaXMgMCBoZXJlLlxuICAgIGlmICh0b3VjaC5pZGVudGlmaWVyICYmIHRvdWNoLmlkZW50aWZpZXIgPT09IHRoaXMubGFzdFRvdWNoSWRlbnRpZmllcikge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgdGhpcy5sYXN0VG91Y2hJZGVudGlmaWVyID0gdG91Y2guaWRlbnRpZmllclxuXG4gICAgLy8gSWYgdGhlIHRhcmdldCBlbGVtZW50IGlzIGEgY2hpbGQgb2YgYSBzY3JvbGxhYmxlIGxheWVyICh1c2luZyAtd2Via2l0LW92ZXJmbG93LXNjcm9sbGluZzogdG91Y2gpIGFuZDpcbiAgICAvLyAxKSB0aGUgdXNlciBkb2VzIGEgZmxpbmcgc2Nyb2xsIG9uIHRoZSBzY3JvbGxhYmxlIGxheWVyXG4gICAgLy8gMikgdGhlIHVzZXIgc3RvcHMgdGhlIGZsaW5nIHNjcm9sbCB3aXRoIGFub3RoZXIgdGFwXG4gICAgLy8gdGhlbiB0aGUgZXZlbnQudGFyZ2V0IG9mIHRoZSBsYXN0ICd0b3VjaGVuZCcgZXZlbnQgd2lsbCBiZSB0aGUgZWxlbWVudCB0aGF0IHdhcyB1bmRlciB0aGUgdXNlcidzIGZpbmdlclxuICAgIC8vIHdoZW4gdGhlIGZsaW5nIHNjcm9sbCB3YXMgc3RhcnRlZCwgY2F1c2luZyBGYXN0Q2xpY2sgdG8gc2VuZCBhIGNsaWNrIGV2ZW50IHRvIHRoYXQgbGF5ZXIgLSB1bmxlc3MgYSBjaGVja1xuICAgIC8vIGlzIG1hZGUgdG8gZW5zdXJlIHRoYXQgYSBwYXJlbnQgbGF5ZXIgd2FzIG5vdCBzY3JvbGxlZCBiZWZvcmUgc2VuZGluZyBhIHN5bnRoZXRpYyBjbGljayAoaXNzdWUgIzQyKS5cbiAgICB0aGlzLnVwZGF0ZVNjcm9sbFBhcmVudCh0YXJnZXRFbGVtZW50KVxuXG4gICAgdGhpcy50cmFja2luZ0NsaWNrID0gdHJ1ZVxuICAgIHRoaXMudHJhY2tpbmdDbGlja1N0YXJ0ID0gZXZlbnQudGltZVN0YW1wXG4gICAgdGhpcy50YXJnZXRFbGVtZW50ID0gdGFyZ2V0RWxlbWVudFxuXG4gICAgdGhpcy50b3VjaFN0YXJ0WCA9IHRvdWNoLnBhZ2VYXG4gICAgdGhpcy50b3VjaFN0YXJ0WSA9IHRvdWNoLnBhZ2VZXG5cbiAgICAvLyBQcmV2ZW50IHBoYW50b20gY2xpY2tzIG9uIGZhc3QgZG91YmxlLXRhcCAoaXNzdWUgIzM2KVxuICAgIGlmICgoZXZlbnQudGltZVN0YW1wIC0gdGhpcy5sYXN0Q2xpY2tUaW1lKSA8IHRoaXMudGFwRGVsYXkpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cblxuICAvKipcbiAgICogQmFzZWQgb24gYSB0b3VjaG1vdmUgZXZlbnQgb2JqZWN0LCBjaGVjayB3aGV0aGVyIHRoZSB0b3VjaCBoYXMgbW92ZWQgcGFzdCBhIGJvdW5kYXJ5IHNpbmNlIGl0IHN0YXJ0ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgRmFzdENsaWNrLnByb3RvdHlwZS50b3VjaEhhc01vdmVkID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgdG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXSwgYm91bmRhcnkgPSB0aGlzLnRvdWNoQm91bmRhcnlcblxuICAgIGlmIChNYXRoLmFicyh0b3VjaC5wYWdlWCAtIHRoaXMudG91Y2hTdGFydFgpID4gYm91bmRhcnkgfHwgTWF0aC5hYnModG91Y2gucGFnZVkgLSB0aGlzLnRvdWNoU3RhcnRZKSA+IGJvdW5kYXJ5KSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBsYXN0IHBvc2l0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIEZhc3RDbGljay5wcm90b3R5cGUub25Ub3VjaE1vdmUgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghdGhpcy50cmFja2luZ0NsaWNrKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIC8vIElmIHRoZSB0b3VjaCBoYXMgbW92ZWQsIGNhbmNlbCB0aGUgY2xpY2sgdHJhY2tpbmdcbiAgICBpZiAodGhpcy50YXJnZXRFbGVtZW50ICE9PSB0aGlzLmdldFRhcmdldEVsZW1lbnRGcm9tRXZlbnRUYXJnZXQoZXZlbnQudGFyZ2V0KSB8fCB0aGlzLnRvdWNoSGFzTW92ZWQoZXZlbnQpKSB7XG4gICAgICB0aGlzLnRyYWNraW5nQ2xpY2sgPSBmYWxzZVxuICAgICAgdGhpcy50YXJnZXRFbGVtZW50ID0gbnVsbFxuICAgIH1cblxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuXG4gIC8qKlxuICAgKiBBdHRlbXB0IHRvIGZpbmQgdGhlIGxhYmVsbGVkIGNvbnRyb2wgZm9yIHRoZSBnaXZlbiBsYWJlbCBlbGVtZW50LlxuICAgKlxuICAgKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fEhUTUxMYWJlbEVsZW1lbnR9IGxhYmVsRWxlbWVudFxuICAgKiBAcmV0dXJucyB7RWxlbWVudHxudWxsfVxuICAgKi9cbiAgRmFzdENsaWNrLnByb3RvdHlwZS5maW5kQ29udHJvbCA9IGZ1bmN0aW9uKGxhYmVsRWxlbWVudCkge1xuXG4gICAgLy8gRmFzdCBwYXRoIGZvciBuZXdlciBicm93c2VycyBzdXBwb3J0aW5nIHRoZSBIVE1MNSBjb250cm9sIGF0dHJpYnV0ZVxuICAgIGlmIChsYWJlbEVsZW1lbnQuY29udHJvbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gbGFiZWxFbGVtZW50LmNvbnRyb2xcbiAgICB9XG5cbiAgICAvLyBBbGwgYnJvd3NlcnMgdW5kZXIgdGVzdCB0aGF0IHN1cHBvcnQgdG91Y2ggZXZlbnRzIGFsc28gc3VwcG9ydCB0aGUgSFRNTDUgaHRtbEZvciBhdHRyaWJ1dGVcbiAgICBpZiAobGFiZWxFbGVtZW50Lmh0bWxGb3IpIHtcbiAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsYWJlbEVsZW1lbnQuaHRtbEZvcilcbiAgICB9XG5cbiAgICAvLyBJZiBubyBmb3IgYXR0cmlidXRlIGV4aXN0cywgYXR0ZW1wdCB0byByZXRyaWV2ZSB0aGUgZmlyc3QgbGFiZWxsYWJsZSBkZXNjZW5kYW50IGVsZW1lbnRcbiAgICAvLyB0aGUgbGlzdCBvZiB3aGljaCBpcyBkZWZpbmVkIGhlcmU6IGh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWw1L2Zvcm1zLmh0bWwjY2F0ZWdvcnktbGFiZWxcbiAgICByZXR1cm4gbGFiZWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbiwgaW5wdXQ6bm90KFt0eXBlPWhpZGRlbl0pLCBrZXlnZW4sIG1ldGVyLCBvdXRwdXQsIHByb2dyZXNzLCBzZWxlY3QsIHRleHRhcmVhJylcbiAgfVxuXG5cbiAgLyoqXG4gICAqIE9uIHRvdWNoIGVuZCwgZGV0ZXJtaW5lIHdoZXRoZXIgdG8gc2VuZCBhIGNsaWNrIGV2ZW50IGF0IG9uY2UuXG4gICAqXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgRmFzdENsaWNrLnByb3RvdHlwZS5vblRvdWNoRW5kID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgZm9yRWxlbWVudCwgdHJhY2tpbmdDbGlja1N0YXJ0LCB0YXJnZXRUYWdOYW1lLCBzY3JvbGxQYXJlbnQsIHRhcmdldEVsZW1lbnQgPSB0aGlzLnRhcmdldEVsZW1lbnRcblxuICAgIGlmICghdGhpcy50cmFja2luZ0NsaWNrKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIC8vIFByZXZlbnQgcGhhbnRvbSBjbGlja3Mgb24gZmFzdCBkb3VibGUtdGFwIChpc3N1ZSAjMzYpXG4gICAgaWYgKChldmVudC50aW1lU3RhbXAgLSB0aGlzLmxhc3RDbGlja1RpbWUpIDwgdGhpcy50YXBEZWxheSkge1xuICAgICAgdGhpcy5jYW5jZWxOZXh0Q2xpY2sgPSB0cnVlXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIGlmICgoZXZlbnQudGltZVN0YW1wIC0gdGhpcy50cmFja2luZ0NsaWNrU3RhcnQpID4gdGhpcy50YXBUaW1lb3V0KSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIC8vIFJlc2V0IHRvIHByZXZlbnQgd3JvbmcgY2xpY2sgY2FuY2VsIG9uIGlucHV0IChpc3N1ZSAjMTU2KS5cbiAgICB0aGlzLmNhbmNlbE5leHRDbGljayA9IGZhbHNlXG5cbiAgICB0aGlzLmxhc3RDbGlja1RpbWUgPSBldmVudC50aW1lU3RhbXBcblxuICAgIHRyYWNraW5nQ2xpY2tTdGFydCA9IHRoaXMudHJhY2tpbmdDbGlja1N0YXJ0XG4gICAgdGhpcy50cmFja2luZ0NsaWNrID0gZmFsc2VcbiAgICB0aGlzLnRyYWNraW5nQ2xpY2tTdGFydCA9IDBcblxuICAgIHRhcmdldFRhZ05hbWUgPSB0YXJnZXRFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKVxuICAgIGlmICh0YXJnZXRUYWdOYW1lID09PSAnbGFiZWwnKSB7XG4gICAgICBmb3JFbGVtZW50ID0gdGhpcy5maW5kQ29udHJvbCh0YXJnZXRFbGVtZW50KVxuICAgICAgaWYgKGZvckVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5mb2N1cyh0YXJnZXRFbGVtZW50KVxuICAgICAgICB0YXJnZXRFbGVtZW50ID0gZm9yRWxlbWVudFxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5uZWVkc0ZvY3VzKHRhcmdldEVsZW1lbnQpKSB7XG5cbiAgICAgIC8vIENhc2UgMTogSWYgdGhlIHRvdWNoIHN0YXJ0ZWQgYSB3aGlsZSBhZ28gKGJlc3QgZ3Vlc3MgaXMgMTAwbXMgYmFzZWQgb24gdGVzdHMgZm9yIGlzc3VlICMzNikgdGhlbiBmb2N1cyB3aWxsIGJlIHRyaWdnZXJlZCBhbnl3YXkuIFJldHVybiBlYXJseSBhbmQgdW5zZXQgdGhlIHRhcmdldCBlbGVtZW50IHJlZmVyZW5jZSBzbyB0aGF0IHRoZSBzdWJzZXF1ZW50IGNsaWNrIHdpbGwgYmUgYWxsb3dlZCB0aHJvdWdoLlxuICAgICAgLy8gQ2FzZSAyOiBXaXRob3V0IHRoaXMgZXhjZXB0aW9uIGZvciBpbnB1dCBlbGVtZW50cyB0YXBwZWQgd2hlbiB0aGUgZG9jdW1lbnQgaXMgY29udGFpbmVkIGluIGFuIGlmcmFtZSwgdGhlbiBhbnkgaW5wdXR0ZWQgdGV4dCB3b24ndCBiZSB2aXNpYmxlIGV2ZW4gdGhvdWdoIHRoZSB2YWx1ZSBhdHRyaWJ1dGUgaXMgdXBkYXRlZCBhcyB0aGUgdXNlciB0eXBlcyAoaXNzdWUgIzM3KS5cbiAgICAgIGlmICgoZXZlbnQudGltZVN0YW1wIC0gdHJhY2tpbmdDbGlja1N0YXJ0KSA+IDEwMCB8fCAod2luZG93LnRvcCAhPT0gd2luZG93ICYmIHRhcmdldFRhZ05hbWUgPT09ICdpbnB1dCcpKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudCA9IG51bGxcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG5cbiAgICAgIHRoaXMuZm9jdXModGFyZ2V0RWxlbWVudClcbiAgICAgIHRoaXMuc2VuZENsaWNrKHRhcmdldEVsZW1lbnQsIGV2ZW50KVxuXG4gICAgICAvLyBTZWxlY3QgZWxlbWVudHMgbmVlZCB0aGUgZXZlbnQgdG8gZ28gdGhyb3VnaCBvbiBpT1MgNCwgb3RoZXJ3aXNlIHRoZSBzZWxlY3RvciBtZW51IHdvbid0IG9wZW4uXG4gICAgICAvLyBBbHNvIHRoaXMgYnJlYWtzIG9wZW5pbmcgc2VsZWN0cyB3aGVuIFZvaWNlT3ZlciBpcyBhY3RpdmUgb24gaU9TNiwgaU9TNyAoYW5kIHBvc3NpYmx5IG90aGVycylcbiAgICAgIGlmICh0YXJnZXRUYWdOYW1lICE9PSAnc2VsZWN0Jykge1xuICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnQgPSBudWxsXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgLy8gRG9uJ3Qgc2VuZCBhIHN5bnRoZXRpYyBjbGljayBldmVudCBpZiB0aGUgdGFyZ2V0IGVsZW1lbnQgaXMgY29udGFpbmVkIHdpdGhpbiBhIHBhcmVudCBsYXllciB0aGF0IHdhcyBzY3JvbGxlZFxuICAgIC8vIGFuZCB0aGlzIHRhcCBpcyBiZWluZyB1c2VkIHRvIHN0b3AgdGhlIHNjcm9sbGluZyAodXN1YWxseSBpbml0aWF0ZWQgYnkgYSBmbGluZyAtIGlzc3VlICM0MikuXG4gICAgc2Nyb2xsUGFyZW50ID0gdGFyZ2V0RWxlbWVudC5mYXN0Q2xpY2tTY3JvbGxQYXJlbnRcbiAgICBpZiAoc2Nyb2xsUGFyZW50ICYmIHNjcm9sbFBhcmVudC5mYXN0Q2xpY2tMYXN0U2Nyb2xsVG9wICE9PSBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIC8vIFByZXZlbnQgdGhlIGFjdHVhbCBjbGljayBmcm9tIGdvaW5nIHRob3VnaCAtIHVubGVzcyB0aGUgdGFyZ2V0IG5vZGUgaXMgbWFya2VkIGFzIHJlcXVpcmluZ1xuICAgIC8vIHJlYWwgY2xpY2tzIG9yIGlmIGl0IGlzIGluIHRoZSBhbGxvd2xpc3QgaW4gd2hpY2ggY2FzZSBvbmx5IG5vbi1wcm9ncmFtbWF0aWMgY2xpY2tzIGFyZSBwZXJtaXR0ZWQuXG4gICAgaWYgKCF0aGlzLm5lZWRzQ2xpY2sodGFyZ2V0RWxlbWVudCkpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgIHRoaXMuc2VuZENsaWNrKHRhcmdldEVsZW1lbnQsIGV2ZW50KVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cblxuICAvKipcbiAgICogT24gdG91Y2ggY2FuY2VsLCBzdG9wIHRyYWNraW5nIHRoZSBjbGljay5cbiAgICpcbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuICBGYXN0Q2xpY2sucHJvdG90eXBlLm9uVG91Y2hDYW5jZWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRyYWNraW5nQ2xpY2sgPSBmYWxzZVxuICAgIHRoaXMudGFyZ2V0RWxlbWVudCA9IG51bGxcbiAgfVxuXG5cbiAgLyoqXG4gICAqIERldGVybWluZSBtb3VzZSBldmVudHMgd2hpY2ggc2hvdWxkIGJlIHBlcm1pdHRlZC5cbiAgICpcbiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnRcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICBGYXN0Q2xpY2sucHJvdG90eXBlLm9uTW91c2UgPSBmdW5jdGlvbihldmVudCkge1xuXG4gICAgLy8gSWYgYSB0YXJnZXQgZWxlbWVudCB3YXMgbmV2ZXIgc2V0IChiZWNhdXNlIGEgdG91Y2ggZXZlbnQgd2FzIG5ldmVyIGZpcmVkKSBhbGxvdyB0aGUgZXZlbnRcbiAgICBpZiAoIXRoaXMudGFyZ2V0RWxlbWVudCkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQuZm9yd2FyZGVkVG91Y2hFdmVudCkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICAvLyBQcm9ncmFtbWF0aWNhbGx5IGdlbmVyYXRlZCBldmVudHMgdGFyZ2V0aW5nIGEgc3BlY2lmaWMgZWxlbWVudCBzaG91bGQgYmUgcGVybWl0dGVkXG4gICAgaWYgKCFldmVudC5jYW5jZWxhYmxlKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIC8vIERlcml2ZSBhbmQgY2hlY2sgdGhlIHRhcmdldCBlbGVtZW50IHRvIHNlZSB3aGV0aGVyIHRoZSBtb3VzZSBldmVudCBuZWVkcyB0byBiZSBwZXJtaXR0ZWRcbiAgICAvLyB1bmxlc3MgZXhwbGljaXRseSBlbmFibGVkLCBwcmV2ZW50IG5vbi10b3VjaCBjbGljayBldmVudHMgZnJvbSB0cmlnZ2VyaW5nIGFjdGlvbnMsXG4gICAgLy8gdG8gcHJldmVudCBnaG9zdC9kb3VibGVjbGlja3MuXG4gICAgaWYgKCF0aGlzLm5lZWRzQ2xpY2sodGhpcy50YXJnZXRFbGVtZW50KSB8fCB0aGlzLmNhbmNlbE5leHRDbGljaykge1xuXG4gICAgICAvLyBQcmV2ZW50IGFueSB1c2VyLWFkZGVkIGxpc3RlbmVycyBkZWNsYXJlZCBvbiBGYXN0Q2xpY2sgZWxlbWVudCBmcm9tIGJlaW5nIGZpcmVkLlxuICAgICAgaWYgKGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbikge1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKVxuICAgICAgfSBlbHNlIHtcblxuICAgICAgICAvLyBQYXJ0IG9mIHRoZSBoYWNrIGZvciBicm93c2VycyB0aGF0IGRvbid0IHN1cHBvcnQgRXZlbnQjc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIChlLmcuIEFuZHJvaWQgMilcbiAgICAgICAgZXZlbnQucHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZVxuICAgICAgfVxuXG4gICAgICAvLyBDYW5jZWwgdGhlIGV2ZW50XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgbW91c2UgZXZlbnQgaXMgcGVybWl0dGVkLCByZXR1cm4gdHJ1ZSBmb3IgdGhlIGFjdGlvbiB0byBnbyB0aHJvdWdoLlxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuXG4gIC8qKlxuICAgKiBPbiBhY3R1YWwgY2xpY2tzLCBkZXRlcm1pbmUgd2hldGhlciB0aGlzIGlzIGEgdG91Y2gtZ2VuZXJhdGVkIGNsaWNrLCBhIGNsaWNrIGFjdGlvbiBvY2N1cnJpbmdcbiAgICogbmF0dXJhbGx5IGFmdGVyIGEgZGVsYXkgYWZ0ZXIgYSB0b3VjaCAod2hpY2ggbmVlZHMgdG8gYmUgY2FuY2VsbGVkIHRvIGF2b2lkIGR1cGxpY2F0aW9uKSwgb3JcbiAgICogYW4gYWN0dWFsIGNsaWNrIHdoaWNoIHNob3VsZCBiZSBwZXJtaXR0ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgRmFzdENsaWNrLnByb3RvdHlwZS5vbkNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgcGVybWl0dGVkXG5cbiAgICAvLyBJdCdzIHBvc3NpYmxlIGZvciBhbm90aGVyIEZhc3RDbGljay1saWtlIGxpYnJhcnkgZGVsaXZlcmVkIHdpdGggdGhpcmQtcGFydHkgY29kZSB0byBmaXJlIGEgY2xpY2sgZXZlbnQgYmVmb3JlIEZhc3RDbGljayBkb2VzIChpc3N1ZSAjNDQpLiBJbiB0aGF0IGNhc2UsIHNldCB0aGUgY2xpY2stdHJhY2tpbmcgZmxhZyBiYWNrIHRvIGZhbHNlIGFuZCByZXR1cm4gZWFybHkuIFRoaXMgd2lsbCBjYXVzZSBvblRvdWNoRW5kIHRvIHJldHVybiBlYXJseS5cbiAgICBpZiAodGhpcy50cmFja2luZ0NsaWNrKSB7XG4gICAgICB0aGlzLnRhcmdldEVsZW1lbnQgPSBudWxsXG4gICAgICB0aGlzLnRyYWNraW5nQ2xpY2sgPSBmYWxzZVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICAvLyBWZXJ5IG9kZCBiZWhhdmlvdXIgb24gaU9TIChpc3N1ZSAjMTgpOiBpZiBhIHN1Ym1pdCBlbGVtZW50IGlzIHByZXNlbnQgaW5zaWRlIGEgZm9ybSBhbmQgdGhlIHVzZXIgaGl0cyBlbnRlciBpbiB0aGUgaU9TIHNpbXVsYXRvciBvciBjbGlja3MgdGhlIEdvIGJ1dHRvbiBvbiB0aGUgcG9wLXVwIE9TIGtleWJvYXJkIHRoZSBhIGtpbmQgb2YgJ2Zha2UnIGNsaWNrIGV2ZW50IHdpbGwgYmUgdHJpZ2dlcmVkIHdpdGggdGhlIHN1Ym1pdC10eXBlIGlucHV0IGVsZW1lbnQgYXMgdGhlIHRhcmdldC5cbiAgICBpZiAoZXZlbnQudGFyZ2V0LnR5cGUgPT09ICdzdWJtaXQnICYmIGV2ZW50LmRldGFpbCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBwZXJtaXR0ZWQgPSB0aGlzLm9uTW91c2UoZXZlbnQpXG5cbiAgICAvLyBPbmx5IHVuc2V0IHRhcmdldEVsZW1lbnQgaWYgdGhlIGNsaWNrIGlzIG5vdCBwZXJtaXR0ZWQuIFRoaXMgd2lsbCBlbnN1cmUgdGhhdCB0aGUgY2hlY2sgZm9yICF0YXJnZXRFbGVtZW50IGluIG9uTW91c2UgZmFpbHMgYW5kIHRoZSBicm93c2VyJ3MgY2xpY2sgZG9lc24ndCBnbyB0aHJvdWdoLlxuICAgIGlmICghcGVybWl0dGVkKSB7XG4gICAgICB0aGlzLnRhcmdldEVsZW1lbnQgPSBudWxsXG4gICAgfVxuXG4gICAgLy8gSWYgY2xpY2tzIGFyZSBwZXJtaXR0ZWQsIHJldHVybiB0cnVlIGZvciB0aGUgYWN0aW9uIHRvIGdvIHRocm91Z2guXG4gICAgcmV0dXJuIHBlcm1pdHRlZFxuICB9XG5cbiAgZnVuY3Rpb24gaW5pdCAoKSB7XG4gICAgbmV3IEZhc3RDbGljayhkb2N1bWVudC5ib2R5KVxuICB9XG5cbiAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT09ICdsb2FkaW5nJykge1xuICAgIHJldHVybiBpbml0KClcbiAgfVxuXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0LCBmYWxzZSlcbn0oKSlcbiJdLCJuYW1lcyI6WyJjb250ZXh0Il0sIm1hcHBpbmdz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
